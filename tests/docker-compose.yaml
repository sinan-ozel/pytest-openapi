services:
  mock-server-missing-openapi:
    build:
      context: test_servers/missing_openapi
      dockerfile: Dockerfile
    image: mock-server-missing-openapi:latest
    ports:
      - "8001:8000"
    deploy:
      resources:
        limits:
          cpus: '0.1'
          memory: 128M

  mock-server-no-examples:
    build:
      context: test_servers/no_examples
      dockerfile: Dockerfile
    image: mock-server-no-examples:latest
    ports:
      - "8002:8000"
    deploy:
      resources:
        limits:
          cpus: '0.1'
          memory: 128M

  mock-server-valid-api:
    build:
      context: test_servers/valid_api
      dockerfile: Dockerfile
    image: mock-server-valid-api:latest
    ports:
      - "8003:8000"
    deploy:
      resources:
        limits:
          cpus: '0.1'
          memory: 128M

  mock-server-post-500-error:
    build:
      context: test_servers/post_500_error
      dockerfile: Dockerfile
    image: mock-server-post-500-error:latest
    ports:
      - "8004:8000"
    deploy:
      resources:
        limits:
          cpus: '0.1'
          memory: 128M

  mock-server-post-response-missing-key:
    build:
      context: test_servers/post_response_missing_key
      dockerfile: Dockerfile
    image: mock-server-post-response-missing-key:latest
    ports:
      - "8005:8000"
    deploy:
      resources:
        limits:
          cpus: '0.1'
          memory: 128M

  mock-server-post-response-wrong-type:
    build:
      context: test_servers/post_response_wrong_type
      dockerfile: Dockerfile
    image: mock-server-post-response-wrong-type:latest
    ports:
      - "8006:8000"
    deploy:
      resources:
        limits:
          cpus: '0.1'
          memory: 128M

  mock-server-get-missing-key:
    build:
      context: test_servers/get_missing_key
      dockerfile: Dockerfile
    image: mock-server-get-missing-key:latest
    ports:
      - "8007:8000"
    deploy:
      resources:
        limits:
          cpus: '0.1'
          memory: 128M

  mock-server-nested-valid-api:
    build:
      context: test_servers/nested_valid_api
      dockerfile: Dockerfile
    image: mock-server-nested-valid-api:latest
    ports:
      - "8008:8000"
    deploy:
      resources:
        limits:
          cpus: '0.1'
          memory: 128M

  mock-server-missing-descriptions:
    build:
      context: test_servers/missing_descriptions
      dockerfile: Dockerfile
    image: mock-server-missing-descriptions:latest
    ports:
      - "8009:8000"
    deploy:
      resources:
        limits:
          cpus: '0.1'
          memory: 128M

  mock-server-post-example-missing-key:
    build:
      context: test_servers/post_example_missing_key
      dockerfile: Dockerfile
    image: mock-server-post-example-missing-key:latest
    ports:
      - "8010:8000"
    deploy:
      resources:
        limits:
          cpus: '0.1'
          memory: 128M

  mock-server-get-type-mismatch:
    build:
      context: test_servers/get_type_mismatch
      dockerfile: Dockerfile
    image: mock-server-get-type-mismatch:latest
    ports:
      - "8011:8000"
    deploy:
      resources:
        limits:
          cpus: '0.1'
          memory: 128M

  mock-server-delete-wrong-status:
    build:
      context: test_servers/delete_wrong_status
      dockerfile: Dockerfile
    image: mock-server-delete-wrong-status:latest
    ports:
      - "8012:8000"
    deploy:
      resources:
        limits:
          cpus: '0.1'
          memory: 128M

  mock-server-schema-based-api:
    build:
      context: test_servers/schema_based_api
      dockerfile: Dockerfile
    image: mock-server-schema-based-api:latest
    ports:
      - "8013:8000"
    deploy:
      resources:
        limits:
          cpus: '0.1'
          memory: 128M

  mock-server-put-response-missing-key:
    build:
      context: test_servers/put_response_missing_key
      dockerfile: Dockerfile
    image: mock-server-put-response-missing-key:latest
    ports:
      - "8014:8000"
    deploy:
      resources:
        limits:
          cpus: '0.1'
          memory: 128M

  mock-server-email-server:
    build:
      context: test_servers/email_server
      dockerfile: Dockerfile
    image: mock-server-email-server:latest
    ports:
      - "8015:8000"
    deploy:
      resources:
        limits:
          cpus: '0.1'
          memory: 128M

  mock-server-post-501-undocumented:
    build:
      context: test_servers/post_501_undocumented
      dockerfile: Dockerfile
    image: mock-server-post-501-undocumented:latest
    ports:
      - "8016:8000"
    deploy:
      resources:
        limits:
          cpus: '0.1'
          memory: 128M

  mock-server-post-501-documented:
    build:
      context: test_servers/post_501_documented
      dockerfile: Dockerfile
    image: mock-server-post-501-documented:latest
    ports:
      - "8017:8000"
    deploy:
      resources:
        limits:
          cpus: '0.1'
          memory: 128M

  mock-server-example-value-mismatch:
    build:
      context: test_servers/example_value_mismatch
      dockerfile: Dockerfile
    image: mock-server-example-value-mismatch:latest
    ports:
      - "8018:8000"
    deploy:
      resources:
        limits:
          cpus: '0.1'
          memory: 128M

  mock-server-get-returns-404:
    build:
      context: test_servers/get_returns_404
      dockerfile: Dockerfile
    image: mock-server-get-returns-404:latest
    ports:
      - "8019:8000"
    deploy:
      resources:
        limits:
          cpus: '0.1'
          memory: 128M

  test:
    build:
      context: ..
      dockerfile: tests/Dockerfile
    image: pytest-openapi-test:latest
    command: pytest /test_of_tests -vvv
    deploy:
      resources:
        limits:
          cpus: '2.0'
          memory: 3G
